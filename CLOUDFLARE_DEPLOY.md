# Развертывание на Cloudflare Pages

## Проблема
У вас была ошибка HTTP 500 при отправке контактной формы. Это происходило из-за неправильной настройки Cloudflare Pages Functions.

## Что исправлено

### 1. Удален лишний _worker.js
- Удален `_worker.js` из корня проекта
- Оставлен только `_worker.js` в папке `functions`

### 2. Исправлен _redirects
- Убрано неправильное перенаправление API запросов
- Теперь API запросы обрабатываются Cloudflare Functions напрямую

### 3. Обновлен API
- Упрощен API для тестирования
- Убрана зависимость от Slack webhook
- Исправлена обработка ошибок

### 4. Правильная структура
```
out/
├── _worker.js          # Основной worker для Cloudflare Pages
├── functions/
│   ├── _worker.js      # Worker для функций
│   └── api/
│       └── contact.js  # API контактной формы
└── ... (остальные файлы)
```

## Развертывание

### 1. Сборка проекта
```bash
npm run build
```

### 2. Загрузка на Cloudflare Pages
- Загрузите содержимое папки `out` в Cloudflare Pages
- Убедитесь, что включены Functions

### 3. Проверка
- Откройте сайт
- Попробуйте отправить контактную форму
- Проверьте консоль браузера на ошибки

## Переменные окружения (опционально)
Если хотите добавить Slack уведомления:
```
CONTACT_SLACK_WEBHOOK=https://hooks.slack.com/services/...
```

## Тестирование
Используйте файл `test-api.html` для локального тестирования API.

## Возможные проблемы

### 1. Functions не работают
- Проверьте, что Functions включены в Cloudflare Pages
- Убедитесь, что `_worker.js` находится в корне папки `out`

### 2. CORS ошибки
- Проверьте заголовки в API ответах
- Убедитесь, что `Access-Control-Allow-Origin: *` установлен

### 3. 500 ошибки
- Проверьте логи в Cloudflare Dashboard
- Убедитесь, что API файлы правильно импортируются
